<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.vhouzi.abc.admin.notification.mapper.SmsMapper">
  <!-- 查询某号码某种类型当天已发送次数 -->
  <select id="countDayTime" resultType="java.lang.Integer" parameterType="java.util.HashMap">
      SELECT count(1)
      FROM notify_th_sms
      WHERE mobile = #{phone,jdbcType=VARCHAR} AND type = #{smsType, jdbcType = VARCHAR}
            AND DATE_FORMAT(send_time, '%Y-%m-%d') = DATE_FORMAT(NOW(), '%Y-%m-%d')
  </select>

  <select id="countTimes" parameterType="java.util.HashMap" resultType="java.lang.Integer">
    SELECT count(*) from notify_th_sms
    where send_time between DATE_SUB(now(),INTERVAL ${timeLong} HOUR) and NOW() and mobile = #{phone}
  </select>
</mapper>